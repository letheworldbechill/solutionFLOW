<!DOCTYPE html>
<html lang="de" data-clear4-theme="JOY">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Solution FLOW</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#f5a55b" />
  <link rel="icon" href="icons/icon-192.png" />

  <style>
    /* ================= GLOBAL / 4px SYSTEM ================= */

    :root {
      --space-1: 4px;
      --space-2: 8px;
      --space-3: 12px;
      --space-4: 16px;
      --space-5: 20px;
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 20px;

      --soil-1: #F2ECE3;
      --soil-2: #E8E0D5;
      --soil-3: #DCD7C8;
      --soil-4: #CFC8B7;

      --c-bg: #FFF8F2;
      --c-accent: #CC6A2F;
      --c-accent-soft: #FFE0C7;
      --c-surface: #FFFDF9;
      --c-surface-strong: #FFE7D3;
      --c-border: rgba(0, 0, 0, 0.12);
      --c-text: #2A1C14;
      --c-muted: #7B6455;
      --c-danger: #C04848;
      --c-success: #2E7A45;
      --c-success-soft: #DDF5E2;
      --shadow-premium: 0 22px 60px rgba(0,0,0,0.22);
      --shadow-soft: 0 18px 48px rgba(0,0,0,0.18);
    }

    /* THEME 1 – JOYFUL (orange, leicht, fröhlich) */
    :root[data-clear4-theme="JOY"] {
      --c-bg: #FFF7F0;
      --c-accent: #E47E34;
      --c-accent-soft: #FFE0C7;
      --c-surface: #FFFDF9;
      --c-surface-strong: #FFE8D4;
      --c-border: rgba(0, 0, 0, 0.10);
      --c-text: #2B1608;
      --c-muted: #8A6B53;
      --c-danger: #CF5555;
      --c-success: #2F7A4B;
      --c-success-soft: #DDF5E2;
    }

    /* THEME 2 – CLEAR (neutral, klassisch CLEAR4) */
    :root[data-clear4-theme="CLEAR"] {
      --c-bg: #F3EFE7;
      --c-accent: #1F2622;
      --c-accent-soft: #DADFD7;
      --c-surface: #F7F4EE;
      --c-surface-strong: #E8E0D5;
      --c-border: rgba(0, 0, 0, 0.20);
      --c-text: #222222;
      --c-muted: #6b6b6b;
      --c-danger: #C04848;
      --c-success: #2F6B3A;
      --c-success-soft: #DCEFD8;
    }

    /* THEME 3 – DARK (kräftig, fokussiert) */
    :root[data-clear4-theme="DARK"] {
      --c-bg: #080A09;
      --c-accent: #F5A55B;
      --c-accent-soft: #3B2A16;
      --c-surface: #151A17;
      --c-surface-strong: #1F2622;
      --c-border: rgba(255, 255, 255, 0.12);
      --c-text: #F7F3EC;
      --c-muted: #9D9488;
      --c-danger: #FF6B6B;
      --c-success: #6BD58A;
      --c-success-soft: #173325;
      --shadow-premium: 0 22px 60px rgba(0,0,0,0.7);
      --shadow-soft: 0 18px 48px rgba(0,0,0,0.6);
    }

    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    html {
      font-size: 15px;
    }

    @media (max-width: 480px) {
      html { font-size: 14px; }
    }

    @media (min-width: 900px) {
      html { font-size: 16px; }
    }

    body {
      margin: 0;
      min-height: 100vh;
      padding: var(--space-4);
      background: var(--c-bg);
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }

    @media (max-width: 480px) {
      body { padding: var(--space-2); }
    }

    /* Touch-friendly */
    button, textarea {
      touch-action: manipulation;
    }

    .app-shell {
      width: 100%;
      max-width: 440px;
      border-radius: 24px;
      padding: var(--space-4);
      background: linear-gradient(160deg, var(--soil-1), var(--soil-2));
      border: 1px solid rgba(255,255,255,0.4);
      box-shadow: var(--shadow-premium);
      position: relative;
      overflow: hidden;
    }

    @media (min-width: 900px) {
      .app-shell {
        max-width: 620px;
        padding: var(--space-5);
        border-radius: 28px;
      }
    }

    .app-shell::before {
      content: "";
      position: absolute;
      inset: 0;
      background-image: url('https://www.transparenttextures.com/patterns/sand.png');
      background-size: 600px;
      opacity: 0.06;
      pointer-events: none;
      mix-blend-mode: soft-light;
    }

    .app-inner {
      position: relative;
      z-index: 1;
    }

    /* HEADER & THEME-CHIPS */

    .app-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: var(--space-2);
      margin-bottom: var(--space-3);
    }

    .app-title-chip {
      padding: var(--space-2) var(--space-4);
      border-radius: 999px;
      background: rgba(0,0,0,0.78);
      color: #fff;
      font-size: 14px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      box-shadow: 0 10px 26px rgba(0,0,0,0.28);
      white-space: nowrap;
    }

    @media (min-width: 900px) {
      .app-title-chip {
        font-size: 15px;
        padding: var(--space-2) var(--space-5);
      }
    }

    .theme-chips {
      display: inline-flex;
      gap: var(--space-1);
      padding: 2px;
      border-radius: 999px;
      background: rgba(255,255,255,0.9);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(0,0,0,0.06);
    }

    @media (max-width: 480px) {
      .theme-chips { transform: scale(0.9); }
    }

    .chip {
      border-radius: 999px;
      padding: var(--space-1) var(--space-2);
      border: none;
      cursor: pointer;
      font-size: 10px;
      min-width: 32px;
      background: transparent;
      color: var(--c-muted);
      transition: all .18s ease;
    }

    .chip-label {
      display: block;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: .06em;
    }

    .chip-sub {
      display: block;
      font-size: 9px;
      opacity: 0.7;
    }

    .chip.active {
      background: var(--c-accent);
      color: #fff;
      transform: translateY(-1px);
      box-shadow: 0 10px 26px rgba(0,0,0,0.25);
    }

    .chip:hover:not(.active) {
      background: rgba(0,0,0,0.06);
      transform: translateY(-1px);
    }

    /* PX-CARDS / GLOW / HOVER */

    .px-card {
      position: relative;
      overflow: hidden;
      background: var(--c-surface);
      border-radius: var(--radius-md);
      border: 1px solid var(--c-border);
      box-shadow: var(--shadow-soft);
      transition: transform .22s ease, box-shadow .22s ease, background .18s ease;
    }

    .px-card::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(
        circle at var(--mx, 50%) var(--my, 50%),
        rgba(255,255,255,0.18),
        transparent 60%
      );
      pointer-events: none;
      opacity: 0;
      transition: opacity .2s ease;
    }

    .px-card:hover::after {
      opacity: 1;
    }

    .px-hoverlift:hover {
      transform: translateY(-4px) scale(1.01);
      box-shadow: var(--shadow-premium);
    }

    /* STEP CARD */

    .step-card {
      padding: var(--space-3);
      display: flex;
      flex-direction: column;
      gap: var(--space-2);
      margin-bottom: var(--space-3);
    }

    .step-card.completed {
      background: var(--c-success-soft);
      border-color: var(--c-success);
    }

    .step-label {
      font-size: 14px;
      font-weight: 600;
      color: var(--c-text);
    }

    .step-subtitle {
      font-size: 11px;
      color: var(--c-muted);
    }

    textarea {
      width: 100%;
      min-height: 120px;
      border-radius: 12px;
      padding: var(--space-2);
      resize: vertical;
      font-size: 14px;
      border: 1px solid rgba(0,0,0,0.20);
      background: #F7F4EE;
    }

    [data-clear4-theme="DARK"] textarea {
      background: #1E231F;
      border-color: rgba(255,255,255,0.12);
      color: var(--c-text);
    }

    textarea:disabled {
      background: #ECE8DF;
      color: #444;
    }

    [data-clear4-theme="DARK"] textarea:disabled {
      background: #262D28;
      color: var(--c-muted);
    }

    .step-actions {
      display: flex;
      justify-content: flex-end;
      margin-top: var(--space-1);
    }

    /* BUTTONS */

    .btn {
      border-radius: 14px;
      padding: 10px 20px;
      border: none;
      cursor: pointer;
      font-size: 14px;
      transition: all .22s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
      white-space: nowrap;
      min-height: 40px;
    }

    .btn-primary {
      background: var(--c-accent);
      color: white;
      box-shadow: 0 10px 26px rgba(0,0,0,0.18);
    }

    .btn-primary:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 14px 32px rgba(0,0,0,0.24);
    }

    .btn-primary:disabled {
      opacity: 0.5;
      cursor: default;
      box-shadow: none;
      transform: none;
    }

    .btn-ghost {
      background: transparent;
      border-radius: 999px;
      border: none;
      color: var(--c-muted);
      font-size: 12px;
      cursor: pointer;
      text-decoration: underline;
      padding: var(--space-1) var(--space-2);
      min-height: 32px;
    }

    /* STEP-TABS */

    .btn-row {
      display: flex;
      flex-direction: column;
      gap: var(--space-2);
      margin-top: var(--space-2);
    }

    @media (min-width: 480px) {
      .btn-row {
        flex-direction: row;
      }
    }

    .btn-tab {
      flex: 1;
      padding: var(--space-2) var(--space-3);
      border-radius: 999px;
      border: 1px solid var(--c-danger);
      background: rgba(192,72,72,0.06);
      color: var(--c-danger);
      font-weight: 500;
      font-size: 13px;
      cursor: pointer;
      transition: all .18s ease;
      min-height: 40px;
    }

    .btn-tab.active {
      border-color: var(--c-accent);
      background: var(--c-accent-soft);
      color: var(--c-accent);
    }

    .btn-tab.completed {
      border-color: var(--c-success);
      background: var(--c-success-soft);
      color: var(--c-success);
    }

    /* STATUS & SUMMARY */

    #status {
      margin-top: var(--space-2);
      font-size: 11px;
      color: var(--c-muted);
      text-align: center;
    }

    #status.completed {
      color: var(--c-success);
      font-weight: 500;
    }

    .summary {
      margin-top: var(--space-4);
      padding-top: var(--space-3);
      border-top: 1px dashed rgba(0,0,0,0.18);
      display: none;
    }

    .summary.visible {
      display: block;
    }

    .summary-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: var(--space-2);
      color: var(--c-text);
    }

    .summary-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--space-2);
    }

    .summary-card {
      padding: var(--space-2);
      border-radius: var(--radius-sm);
      border: 1px solid var(--c-border);
      background: var(--c-surface);
      font-size: 12px;
    }

    .summary-card.large {
      grid-column: 1 / -1;
      font-size: 13px;
    }

    .summary-label {
      font-weight: 600;
      margin-bottom: var(--space-1);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: .05em;
      color: var(--c-muted);
    }

    .summary-text {
      white-space: pre-wrap;
      font-size: inherit;
      color: var(--c-text);
    }

    /* FOOTER & HISTORY */

    .footer-actions {
      margin-top: var(--space-3);
      text-align: center;
    }

    .history {
      margin-top: var(--space-4);
      padding-top: var(--space-3);
      border-top: 1px dashed rgba(0,0,0,0.16);
    }

    .history-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-2);
      gap: var(--space-2);
    }

    .history-title {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: .06em;
      color: var(--c-muted);
    }

    .history-list {
      display: flex;
      flex-direction: column;
      gap: var(--space-2);
      max-height: 180px;
      overflow-y: auto;
      padding-right: 2px;
    }

    @media (min-width: 900px) {
      .history-list {
        max-height: 260px;
        padding-right: 4px;
      }

      .history-item {
        padding: var(--space-3);
        font-size: 12px;
      }
    }

    .history-item {
      padding: var(--space-2);
      border-radius: 10px;
      border: 1px solid rgba(0,0,0,0.12);
      background: rgba(255,255,255,0.8);
      font-size: 11px;
      display: flex;
      flex-direction: column;
      gap: 2px;
      cursor: pointer;
    }

    [data-clear4-theme="DARK"] .history-item {
      background: #1B221F;
      border-color: rgba(255,255,255,0.10);
    }

    .history-item-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: var(--space-2);
    }

    .history-emotion {
      font-weight: 500;
      color: var(--c-text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 220px;
    }

    .history-date {
      font-size: 10px;
      color: var(--c-muted);
      white-space: nowrap;
    }

    .history-meta {
      font-size: 10px;
      color: var(--c-muted);
    }

    .history-empty {
      font-size: 11px;
      color: var(--c-muted);
      font-style: italic;
    }

    /* DETAIL OVERLAY / MODAL */

    .detail-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.45);
      backdrop-filter: blur(4px);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: var(--space-4);
      z-index: 2000;
    }

    .detail-overlay.hidden {
      display: none;
    }

    .detail-card {
      width: 100%;
      max-width: 420px;
      padding: var(--space-4);
      border-radius: var(--radius-lg);
      background: var(--c-surface);
      box-shadow: var(--shadow-premium);
      display: flex;
      flex-direction: column;
      gap: var(--space-3);
    }

    @media (max-width: 480px) {
      .detail-card {
        height: 90vh;
        overflow-y: auto;
      }
    }

    .detail-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .detail-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--c-accent);
    }

    .detail-close {
      background: transparent;
      border: none;
      font-size: 26px;
      line-height: 20px;
      cursor: pointer;
      color: var(--c-muted);
      padding: 4px;
    }

    .detail-close:hover {
      color: var(--c-text);
    }

    .detail-section {
      display: flex;
      flex-direction: column;
      gap: var(--space-1);
    }

    .detail-label {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      color: var(--c-muted);
      letter-spacing: .05em;
    }

    .detail-text {
      white-space: pre-wrap;
      font-size: 14px;
      color: var(--c-text);
      line-height: 1.45;
    }
  </style>
</head>
<body>
  <div class="app-shell px-card px-hoverlift">
    <div class="app-inner">
      <header class="app-header">
        <div class="app-title-chip">Solution FLOW</div>
        <div class="theme-chips">
          <button class="chip" data-theme="JOY">
            <span class="chip-label">Joy</span>
            <span class="chip-sub">leicht</span>
          </button>
          <button class="chip" data-theme="CLEAR">
            <span class="chip-label">Clear</span>
            <span class="chip-sub">neutral</span>
          </button>
          <button class="chip" data-theme="DARK">
            <span class="chip-label">Deep</span>
            <span class="chip-sub">fokussiert</span>
          </button>
        </div>
      </header>

      <!-- Schritt-Karte -->
      <div id="step-card" class="step-card px-card px-hoverlift">
        <div id="step-label" class="step-label"></div>
        <div id="step-subtitle" class="step-subtitle"></div>
        <textarea id="step-text"></textarea>
        <div class="step-actions">
          <button id="confirm-btn" class="btn btn-primary">Bestätigen</button>
        </div>
      </div>

      <!-- Tabs -->
      <div class="btn-row">
        <button id="tab-emotion" class="btn-tab">Emotion</button>
        <button id="tab-situation" class="btn-tab">Reale Situation</button>
        <button id="tab-solution" class="btn-tab">Ursache beheben</button>
      </div>

      <div id="status"></div>

      <!-- Zusammenfassung -->
      <section id="summary" class="summary">
        <div class="summary-title">Zusammenfassung dieses Problems</div>
        <div class="summary-grid">
          <div class="summary-card px-card">
            <div class="summary-label">Emotion</div>
            <div id="summary-emotion" class="summary-text"></div>
          </div>
          <div class="summary-card px-card">
            <div class="summary-label">Reale Situation</div>
            <div id="summary-situation" class="summary-text"></div>
          </div>
          <div class="summary-card large px-card">
            <div class="summary-label">Lösungen &amp; Schritte</div>
            <div id="summary-solution" class="summary-text"></div>
          </div>
        </div>
      </section>

      <div class="footer-actions">
        <button id="new-problem-btn" class="btn-ghost">Neues Problem starten</button>
      </div>

      <!-- History -->
      <section class="history">
        <div class="history-header">
          <div class="history-title">Abgeschlossene Probleme</div>
        </div>
        <div id="history-list" class="history-list">
          <div class="history-empty">Noch keine abgeschlossenen Probleme.</div>
        </div>
      </section>
    </div>
  </div>

  <!-- Detail-Overlay -->
  <div id="detail-overlay" class="detail-overlay hidden">
    <div class="detail-card px-card px-hoverlift">
      <div class="detail-header">
        <div class="detail-title">Problem-Details</div>
        <button id="detail-close" class="detail-close">×</button>
      </div>

      <div class="detail-section">
        <div class="detail-label">Emotion</div>
        <div id="detail-emotion" class="detail-text"></div>
      </div>

      <div class="detail-section">
        <div class="detail-label">Reale Situation</div>
        <div id="detail-situation" class="detail-text"></div>
      </div>

      <div class="detail-section">
        <div class="detail-label">Lösungen &amp; Schritte</div>
        <div id="detail-solution" class="detail-text"></div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
